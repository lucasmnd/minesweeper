# 5. Inference Rules

This section is a collection of rules that allow the player to infer new information from clues explicitly revealed by the game.

It is presumed that the game is not lost.

## 5.1 Fundamental Clue Rule

This is the basic rule that the player uses to transform the clues given by the game into mine distributions.

Let $p \in D$:

$$ v(p) = N \iff \mu = (V(p) \setminus R, N) \text{ is consistent} $$

<details>
<summary><strong>Proof (Direct)</strong></summary>

By definition: 

$$v(p) = N \iff \sum_{q \in V(p)} M(q) = N$$

Since it is presumed that the game is not lost:

$$\forall q \in R \quad (M(q) = 0)$$

It follows that:

$$N = \sum_{q \in V(p)} M(q) = \sum_{q \in (V(p) \cap R)} M(q) + \sum_{q \in (V(p) \setminus R)} M(q) = 0 + \sum_{q \in (V(p) \setminus R)} M(q)$$

$$\therefore \sum_{q \in (V(p) \setminus R)} M(q) = N \iff \mu \text{ is consistent } \tag*{$\blacksquare$}$$

</details>

## 5.2 Containment Reduction Rule

This rule asserts that if a distribution is spatially contained within another, the difference between them yields a new valid distribution.

Let $\mu_1, \mu_2$ be two consistent Mines Distributions.
$$\mu_2 \subseteq \mu_1 \implies (\mu_1 - \mu_2) \text{ is consistent}$$

<details>
<summary><strong>Proof (Direct)</strong></summary>

&nbsp;

$$\mu_1, \mu_2 \text{ consistent} \iff \sum_{q \in \mathcal{P}_1} M(q) = N_1 \quad \land \quad \sum_{q \in \mathcal{P}_2} M(q) = N_2$$

$$\sum_{q \in \mathcal{P}_1} M(q) = \sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q) + \sum_{q \in (\mathcal{P}_1 \cap \mathcal{P}_2)} M(q)$$

As $\mu_2 \subseteq \mu_1 \iff \mathcal{P}_2 \subseteq \mathcal{P}_1 \implies \mathcal{P}_1 \cap \mathcal{P}_2 = \mathcal{P}_2$:

$$\sum_{q \in \mathcal{P}_1} M(q) = \sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q) + \sum_{q \in \mathcal{P}_2} M(q)$$

$$\sum_{q \in \mathcal{P}_1} M(q) - \sum_{q \in \mathcal{P}_2} M(q) = N_1 - N_2 = \sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q)$$

$$\therefore (\mathcal{P}_1 \setminus \mathcal{P}_2, N_1 - N_2) = (\mu_1 - \mu_2) \text{ is consistent} \tag*{$\blacksquare$}$$

</details>


## 5.3 Residual Saturation Rule

This rule establishes the condition under which the residual distribution forces the presence of mines. It provides justification for solving patterns where the difference between overlapping clues reveals necessary mine placement.

Let $\mu_1, \mu_2$ be two consistent Mines Distributions.

$$(N_2 - N_1) = |\mathcal{P}_2 \setminus \mathcal{P}_1| \implies (\mu_2 - \mu_1) \text{ is consistent}$$

---

### 5.3.1 Lemma: Intersection Bound
This lemma asserts that the number of mines in the intersection of two distributions cannot exceed the mine count of either individual distribution.

Let $\mu_1, \mu_2$ be two consistent Mines Distributions.

$$\sum_{q \in (\mathcal{P}_1 \cap \mathcal{P}_2)} M(q) \leq \min \set{N_1, N_2}$$

<details>
<summary><strong>Proof (by Contradiction)</strong></summary>

Suppose for the sake of contradiction:

$$\sum_{q \in (\mathcal{P}_1 \cap \mathcal{P}_2)} M(q) > \min \set{N_1, N_2}$$

Assume, without loss of generality, that $N_1 \leq N_2$.

$$\sum_{q \in (\mathcal{P}_1 \cap \mathcal{P}_2)} M(q) > N_1$$

$$\sum_{q \in \mathcal{P}_1} M(q) = \sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q) + \sum_{q \in (\mathcal{P}_1 \cap \mathcal{P}_2)} M(q)$$

$$N_1 > \sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q) + N_1$$

$$\sum_{q \in (\mathcal{P}_1 \setminus \mathcal{P}_2)} M(q) < 0$$

This is a contradiction, since $\forall q \in D \quad (M(q) \geq 0)$. Therefore, the supposition is false. $\quad \blacksquare$

</details>

---

<details>
<summary><strong>Proof (Direct)</strong></summary>

&nbsp;

$$\mu_1, \mu_2 \text{ consistent} \iff \sum_{q \in \mathcal{P}_1} M(q) = N_1 \quad \land \quad \sum_{q \in \mathcal{P}_2} M(q) = N_2$$

From Lemma 5.3.1, it follows:

$$\sum_{q \in \mathcal{P}_1 \cap \mathcal{P}_2} M(q) \leq \min \set{N_1, N_2}$$

Since $(N_2 - N_1) = |\mathcal{P}_2 \setminus \mathcal{P}_1| \geq 0$, then $N_1 \leq N_2$.

$$\sum_{q \in \mathcal{P}_1 \cap \mathcal{P}_2} M(q) \leq N_1$$

$$\sum_{q \in \mathcal{P}_2} M(q) = 
\sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) + \sum_{q \in (\mathcal{P}_2 \cap \mathcal{P}_1)} M(q) = 
\sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) + \sum_{q \in \mathcal{P}_1 \cap \mathcal{P}_2} M(q)$$

$$\sum_{q \in \mathcal{P}_2} M(q) - \sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) = \sum_{q \in \mathcal{P}_1 \cap \mathcal{P}_2} M(q) \leq N_1$$

$$\sum_{q \in \mathcal{P}_2} M(q) - N_1 = N_2 - N_1 \leq \sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) \tag{1}$$

As $\forall q \in D \quad (M(q) \leq 1)$:

$$\sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) \leq |\mathcal{P}_2 \setminus \mathcal{P}_1| \tag{2}$$

From $(1)$ and $(2)$:

$$N_2 - N_1 \leq \sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) \leq |\mathcal{P}_2 \setminus \mathcal{P}_1| = N_2 - N_1$$

$$\sum_{q \in (\mathcal{P}_2 \setminus \mathcal{P}_1)} M(q) = N_2 - N_1$$

$$\therefore (\mathcal{P}_2 \setminus \mathcal{P}_1, N_2 - N_1) = \mu_2 - \mu_1 \text{ is consistent} \tag*{$\blacksquare$}$$

</details>

Note that the resulting Mines Distribution is also saturated.
